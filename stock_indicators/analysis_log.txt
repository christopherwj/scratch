GPU acceleration enabled for indicators
================================================================================
GPU-ACCELERATED ROLLING ANALYSIS
================================================================================
Ticker: AAPL
Benchmark: SPY
Date Range: 2018-01-01 to 2023-12-31
CPU Cores: 16
GPU Batch Size: 100
Train Window: relativedelta(years=+2)
Test Window: relativedelta(months=+6)
================================================================================
Fetching full data for AAPL...
Loading cached data for AAPL from data\AAPL_2018-01-01_2023-12-31.csv

Starting GPU-accelerated optimization with a constrained grid of 81 valid combinations.
Using 16 CPU cores and batch size of 100 for GPU processing.
GPU acceleration enabled for indicator calculations and batch processing.
Total optimization windows: 7

--- Window 1/7: Train 2018-01-02 to 2020-01-02 | Test 2020-01-02 to 2020-07-02 ---
Running GPU-accelerated optimization for window 1...
Processing 81 valid parameter combinations...
Processing batch 1/1
Running stability analysis...
Optimization completed in 21.01 seconds
Best params for window: RSI Period=28.0, MACD=(21,60,12)
Running backtest for window 1...
Window 1 completed in 21.01s. Elapsed: 0.4min, Estimated remaining: 2.1min

--- Window 2/7: Train 2018-07-02 to 2020-07-02 | Test 2020-07-02 to 2021-01-02 ---
Running GPU-accelerated optimization for window 2...
Processing 81 valid parameter combinations...
Processing batch 1/1
Running stability analysis...
Optimization completed in 21.81 seconds
Best params for window: RSI Period=14.0, MACD=(21,34,16)
Running backtest for window 2...
Window 2 completed in 21.81s. Elapsed: 0.7min, Estimated remaining: 1.8min

--- Window 3/7: Train 2019-01-02 to 2021-01-02 | Test 2021-01-02 to 2021-07-02 ---
Running GPU-accelerated optimization for window 3...
Processing 81 valid parameter combinations...
Processing batch 1/1
Running stability analysis...
Optimization completed in 21.33 seconds
Best params for window: RSI Period=28.0, MACD=(26,60,12)
Running backtest for window 3...
Window 3 completed in 21.33s. Elapsed: 1.1min, Estimated remaining: 1.4min

--- Window 4/7: Train 2019-07-02 to 2021-07-02 | Test 2021-07-02 to 2022-01-02 ---
Running GPU-accelerated optimization for window 4...
Processing 81 valid parameter combinations...
Processing batch 1/1
Running stability analysis...
Optimization completed in 25.21 seconds
Best params for window: RSI Period=21.0, MACD=(26,60,12)
Running backtest for window 4...
Window 4 completed in 25.21s. Elapsed: 1.5min, Estimated remaining: 1.1min

--- Window 5/7: Train 2020-01-02 to 2022-01-02 | Test 2022-01-02 to 2022-07-02 ---
Running GPU-accelerated optimization for window 5...
Processing 81 valid parameter combinations...
Processing batch 1/1
Running stability analysis...
Optimization completed in 25.48 seconds
Best params for window: RSI Period=21.0, MACD=(12,34,16)
Running backtest for window 5...
Window 5 completed in 25.48s. Elapsed: 1.9min, Estimated remaining: 0.8min

--- Window 6/7: Train 2020-07-02 to 2022-07-02 | Test 2022-07-02 to 2023-01-02 ---
Running GPU-accelerated optimization for window 6...
Processing 81 valid parameter combinations...
Processing batch 1/1
Running stability analysis...
Optimization completed in 22.34 seconds
Best params for window: RSI Period=14.0, MACD=(26,60,16)
Running backtest for window 6...
Window 6 completed in 22.34s. Elapsed: 2.3min, Estimated remaining: 0.4min

--- Window 7/7: Train 2021-01-02 to 2023-01-02 | Test 2023-01-02 to 2023-07-02 ---
Running GPU-accelerated optimization for window 7...
Processing 81 valid parameter combinations...
Processing batch 1/1
Running stability analysis...
Optimization completed in 21.58 seconds
Best params for window: RSI Period=14.0, MACD=(12,34,9)
Running backtest for window 7...
Window 7 completed in 21.58s. Elapsed: 2.7min, Estimated remaining: 0.0min

=== GPU-Accelerated Rolling Optimization Completed ===
Total time: 2.65 minutes
Average time per window: 22.72 seconds
Windows processed: 7

Running final backtest for visualization...
Fetching benchmark data for SPY from 2020-01-02 to 2023-06-30...
No cache found for SPY. Fetching from yfinance...
Failed to get ticker 'SPY' reason: Expecting value: line 1 column 1 (char 0)
SPY: No timezone found, symbol may be delisted
